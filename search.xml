<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>代码随想录算法训练营第三天 | 203、707、206</title>
      <link href="/2025/04/25/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%B8%89%E5%A4%A9-203%E3%80%81707%E3%80%81206/"/>
      <url>/2025/04/25/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%B8%89%E5%A4%A9-203%E3%80%81707%E3%80%81206/</url>
      
        <content type="html"><![CDATA[<h2 id="203-移除链表元素"><a href="#203-移除链表元素" class="headerlink" title="203. 移除链表元素"></a>203. 移除链表元素</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="comment">// Definition for singly-linked list.</span></span><br><span class="line"><span class="keyword">type</span> ListNode <span class="keyword">struct</span> &#123;</span><br><span class="line">    Val  <span class="type">int</span></span><br><span class="line">    Next *ListNode</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeElements</span><span class="params">(head *ListNode, val <span class="type">int</span>)</span></span> *ListNode &#123;</span><br><span class="line">    dummy := &amp;ListNode&#123;Next: head&#125;</span><br><span class="line">    cur := dummy</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> cur.Next != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> cur.Next.Val == val &#123;</span><br><span class="line">            cur.Next = cur.Next.Next</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur = cur.Next</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dummy.Next</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="707-设计链表"><a href="#707-设计链表" class="headerlink" title="707. 设计链表"></a>707. 设计链表</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Node <span class="keyword">struct</span> &#123;</span><br><span class="line">    Val  <span class="type">int</span></span><br><span class="line">    Next *Node</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MyLinkedList <span class="keyword">struct</span> &#123;</span><br><span class="line">    dummyHead *Node</span><br><span class="line">    size      <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Constructor</span><span class="params">()</span></span> MyLinkedList &#123;</span><br><span class="line">    <span class="keyword">return</span> MyLinkedList&#123;</span><br><span class="line">        dummyHead: &amp;Node&#123;&#125;, <span class="comment">// 虚拟头节点</span></span><br><span class="line">        size:      <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MyLinkedList)</span></span> Get(index <span class="type">int</span>) <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> index &lt; <span class="number">0</span> || index &gt;= this.size &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    &#125;</span><br><span class="line">    current := this.dummyHead.Next</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; index; i++ &#123;</span><br><span class="line">        current = current.Next</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> current.Val</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MyLinkedList)</span></span> AddAtHead(val <span class="type">int</span>) &#123;</span><br><span class="line">    newNode := &amp;Node&#123;Val: val&#125;</span><br><span class="line">    newNode.Next = this.dummyHead.Next</span><br><span class="line">    this.dummyHead.Next = newNode</span><br><span class="line">    this.size++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MyLinkedList)</span></span> AddAtTail(val <span class="type">int</span>) &#123;</span><br><span class="line">    newNode := &amp;Node&#123;Val: val&#125;</span><br><span class="line">    current := this.dummyHead</span><br><span class="line">    <span class="keyword">for</span> current.Next != <span class="literal">nil</span> &#123;</span><br><span class="line">        current = current.Next</span><br><span class="line">    &#125;</span><br><span class="line">    current.Next = newNode</span><br><span class="line">    this.size++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MyLinkedList)</span></span> AddAtIndex(index <span class="type">int</span>, val <span class="type">int</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> index &gt; this.size &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> index &lt; <span class="number">0</span> &#123;</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    prev := this.dummyHead</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; index; i++ &#123;</span><br><span class="line">        prev = prev.Next</span><br><span class="line">    &#125;</span><br><span class="line">    newNode := &amp;Node&#123;Val: val&#125;</span><br><span class="line">    newNode.Next = prev.Next</span><br><span class="line">    prev.Next = newNode</span><br><span class="line">    this.size++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *MyLinkedList)</span></span> DeleteAtIndex(index <span class="type">int</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> index &lt; <span class="number">0</span> || index &gt;= this.size &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    prev := this.dummyHead</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; index; i++ &#123;</span><br><span class="line">        prev = prev.Next</span><br><span class="line">    &#125;</span><br><span class="line">    prev.Next = prev.Next.Next</span><br><span class="line">    this.size--</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="206-反转链表"><a href="#206-反转链表" class="headerlink" title="206. 反转链表"></a>206. 反转链表</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * type ListNode struct &#123;</span></span><br><span class="line"><span class="comment"> *     Val int</span></span><br><span class="line"><span class="comment"> *     Next *ListNode</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reverseList</span><span class="params">(head *ListNode)</span></span> *ListNode &#123;</span><br><span class="line">    <span class="keyword">var</span> prev *ListNode</span><br><span class="line">    current := head</span><br><span class="line">    <span class="keyword">for</span> current != <span class="literal">nil</span> &#123;</span><br><span class="line">        next := current.Next <span class="comment">// 保存下一个节点</span></span><br><span class="line">        current.Next = prev  <span class="comment">// 当前节点指向前驱</span></span><br><span class="line">        prev = current       <span class="comment">// 前驱节点后移</span></span><br><span class="line">        current = next       <span class="comment">// 当前节点后移</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> prev</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> 算法 </tag>
            
            <tag> 代码随想录算法训练营 </tag>
            
            <tag> 链表 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代码随想录算法训练营第二天 | 209、59、kama58、kama44</title>
      <link href="/2025/04/24/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%BA%8C%E5%A4%A9-209%E3%80%8159%E3%80%81kama58%E3%80%81kama44/"/>
      <url>/2025/04/24/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%BA%8C%E5%A4%A9-209%E3%80%8159%E3%80%81kama58%E3%80%81kama44/</url>
      
        <content type="html"><![CDATA[<h2 id="209-长度最小的子数组"><a href="#209-长度最小的子数组" class="headerlink" title="209. 长度最小的子数组"></a>209. 长度最小的子数组</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minSubArrayLen</span><span class="params">(target <span class="type">int</span>, nums []<span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(nums)</span><br><span class="line">    left, sum := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    minLen := n + <span class="number">1</span> <span class="comment">// 初始化为不可能的大值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> right := <span class="number">0</span>; right &lt; n; right++ &#123;</span><br><span class="line">        sum += nums[right]</span><br><span class="line">        <span class="comment">// 当 sum &gt;= target 时，尝试缩小窗口</span></span><br><span class="line">        <span class="keyword">for</span> sum &gt;= target &#123;</span><br><span class="line">            currentLen := right - left + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> currentLen &lt; minLen &#123;</span><br><span class="line">                minLen = currentLen</span><br><span class="line">            &#125;</span><br><span class="line">            sum -= nums[left]</span><br><span class="line">            left++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> minLen == n+<span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> minLen</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="59-螺旋矩阵-II"><a href="#59-螺旋矩阵-II" class="headerlink" title="59. 螺旋矩阵 II"></a>59. 螺旋矩阵 II</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateMatrix</span><span class="params">(n <span class="type">int</span>)</span></span> [][]<span class="type">int</span> &#123;</span><br><span class="line">    matrix := <span class="built_in">make</span>([][]<span class="type">int</span>, n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> matrix &#123;</span><br><span class="line">        matrix[i] = <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">    &#125;</span><br><span class="line">    start := <span class="number">1</span></span><br><span class="line">    loop := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> loop &lt; n/<span class="number">2</span> &#123;</span><br><span class="line">        <span class="comment">// 填充顶行（左→右）</span></span><br><span class="line">        <span class="keyword">for</span> j := loop; j &lt; n-loop; j++ &#123;</span><br><span class="line">            matrix[loop][j] = start</span><br><span class="line">            start++</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 填充右列（上→下）</span></span><br><span class="line">        <span class="keyword">for</span> i := loop + <span class="number">1</span>; i &lt; n-loop; i++ &#123;</span><br><span class="line">            matrix[i][n-loop<span class="number">-1</span>] = start</span><br><span class="line">            start++</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 填充底行（右→左）</span></span><br><span class="line">        <span class="keyword">for</span> j := n - loop - <span class="number">2</span>; j &gt;= loop; j-- &#123;</span><br><span class="line">            matrix[n-loop<span class="number">-1</span>][j] = start</span><br><span class="line">            start++</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 填充左列（下→上）</span></span><br><span class="line">        <span class="keyword">for</span> i := n - loop - <span class="number">2</span>; i &gt; loop; i-- &#123;</span><br><span class="line">            matrix[i][loop] = start</span><br><span class="line">            start++</span><br><span class="line">        &#125;</span><br><span class="line">        loop++</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理 n 为奇数时的中心元素</span></span><br><span class="line">    <span class="keyword">if</span> n%<span class="number">2</span> != <span class="number">0</span> &#123;</span><br><span class="line">        mid := n / <span class="number">2</span></span><br><span class="line">        matrix[mid][mid] = start</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> matrix</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="kama58-区间和"><a href="#kama58-区间和" class="headerlink" title="kama58. 区间和"></a>kama58. 区间和</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;strconv&quot;</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    scanner := bufio.NewScanner(os.Stdin)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取数组长度 n</span></span><br><span class="line">    scanner.Scan()</span><br><span class="line">    n, _ := strconv.Atoi(scanner.Text())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取数组元素</span></span><br><span class="line">    arr := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">        scanner.Scan()</span><br><span class="line">        num, _ := strconv.Atoi(scanner.Text())</span><br><span class="line">        arr[i] = num</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建前缀和数组</span></span><br><span class="line">    prefix := <span class="built_in">make</span>([]<span class="type">int</span>, n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">        prefix[i] = prefix[i<span class="number">-1</span>] + arr[i<span class="number">-1</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理查询</span></span><br><span class="line">    <span class="keyword">for</span> scanner.Scan() &#123;</span><br><span class="line">        line := scanner.Text()</span><br><span class="line">        line = strings.TrimSpace(line)</span><br><span class="line">        <span class="keyword">if</span> line == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        parts := strings.Split(line, <span class="string">&quot; &quot;</span>)</span><br><span class="line">        a, _ := strconv.Atoi(parts[<span class="number">0</span>])</span><br><span class="line">        b, _ := strconv.Atoi(parts[<span class="number">1</span>])</span><br><span class="line">        sum := prefix[b+<span class="number">1</span>] - prefix[a]</span><br><span class="line">        fmt.Println(sum)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="kama44-开发商购买土地"><a href="#kama44-开发商购买土地" class="headerlink" title="kama44. 开发商购买土地"></a>kama44. 开发商购买土地</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;bufio&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">    <span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    scanner := bufio.NewScanner(os.Stdin)</span><br><span class="line">    scanner.Split(bufio.ScanWords)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取 n 和 m</span></span><br><span class="line">    scanner.Scan()</span><br><span class="line">    n, _ := strconv.Atoi(scanner.Text())</span><br><span class="line">    scanner.Scan()</span><br><span class="line">    m, _ := strconv.Atoi(scanner.Text())</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取矩阵元素</span></span><br><span class="line">    grid := <span class="built_in">make</span>([][]<span class="type">int</span>, n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">        grid[i] = <span class="built_in">make</span>([]<span class="type">int</span>, m)</span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">            scanner.Scan()</span><br><span class="line">            num, _ := strconv.Atoi(scanner.Text())</span><br><span class="line">            grid[i][j] = num</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算总和</span></span><br><span class="line">    total := <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">            total += grid[i][j]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 预处理横向的前缀和</span></span><br><span class="line">    rowSum := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">        sum := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">            sum += grid[i][j]</span><br><span class="line">        &#125;</span><br><span class="line">        rowSum[i] = sum</span><br><span class="line">    &#125;</span><br><span class="line">    rowPrefix := <span class="built_in">make</span>([]<span class="type">int</span>, n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> k := <span class="number">1</span>; k &lt;= n; k++ &#123;</span><br><span class="line">        rowPrefix[k] = rowPrefix[k<span class="number">-1</span>] + rowSum[k<span class="number">-1</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 预处理纵向的前缀和</span></span><br><span class="line">    colSum := <span class="built_in">make</span>([]<span class="type">int</span>, m)</span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; m; j++ &#123;</span><br><span class="line">        sum := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; n; i++ &#123;</span><br><span class="line">            sum += grid[i][j]</span><br><span class="line">        &#125;</span><br><span class="line">        colSum[j] = sum</span><br><span class="line">    &#125;</span><br><span class="line">    colPrefix := <span class="built_in">make</span>([]<span class="type">int</span>, m+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> l := <span class="number">1</span>; l &lt;= m; l++ &#123;</span><br><span class="line">        colPrefix[l] = colPrefix[l<span class="number">-1</span>] + colSum[l<span class="number">-1</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    minDiff := <span class="number">1</span> &lt;&lt; <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理横向切割</span></span><br><span class="line">    <span class="keyword">if</span> n &gt; <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> k := <span class="number">1</span>; k &lt;= n<span class="number">-1</span>; k++ &#123;</span><br><span class="line">            sum := rowPrefix[k]</span><br><span class="line">            diff := abs(<span class="number">2</span>*sum - total)</span><br><span class="line">            <span class="keyword">if</span> diff &lt; minDiff &#123;</span><br><span class="line">                minDiff = diff</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理纵向切割</span></span><br><span class="line">    <span class="keyword">if</span> m &gt; <span class="number">1</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> l := <span class="number">1</span>; l &lt;= m<span class="number">-1</span>; l++ &#123;</span><br><span class="line">            sum := colPrefix[l]</span><br><span class="line">            diff := abs(<span class="number">2</span>*sum - total)</span><br><span class="line">            <span class="keyword">if</span> diff &lt; minDiff &#123;</span><br><span class="line">                minDiff = diff</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fmt.Println(minDiff)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">abs</span><span class="params">(x <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> -x</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> 数组 </tag>
            
            <tag> 算法 </tag>
            
            <tag> 代码随想录算法训练营 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代码随想录算法训练营第一天 | 704、27、977</title>
      <link href="/2025/04/23/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%B8%80%E5%A4%A9-704%E3%80%8127%E3%80%81977/"/>
      <url>/2025/04/23/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95%E7%AE%97%E6%B3%95%E8%AE%AD%E7%BB%83%E8%90%A5%E7%AC%AC%E4%B8%80%E5%A4%A9-704%E3%80%8127%E3%80%81977/</url>
      
        <content type="html"><![CDATA[<h2 id="704-二分查找"><a href="#704-二分查找" class="headerlink" title="704. 二分查找"></a>704. 二分查找</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">search</span><span class="params">(nums []<span class="type">int</span>, target <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    left := <span class="number">0</span></span><br><span class="line">    right := <span class="built_in">len</span>(nums) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> left &lt;= right &#123;</span><br><span class="line">        mid := left + (right-left)/<span class="number">2</span> <span class="comment">// 防止整数溢出</span></span><br><span class="line">        <span class="keyword">if</span> nums[mid] == target &#123;</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> nums[mid] &lt; target &#123;</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right = mid - <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="27-移除元素"><a href="#27-移除元素" class="headerlink" title="27. 移除元素"></a>27. 移除元素</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">removeElement</span><span class="params">(nums []<span class="type">int</span>, val <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">    i := <span class="number">0</span> <span class="comment">// 慢指针，记录有效元素的位置</span></span><br><span class="line">    <span class="comment">// 快指针 j 遍历所有元素</span></span><br><span class="line">    <span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="built_in">len</span>(nums); j++ &#123;</span><br><span class="line">        <span class="keyword">if</span> nums[j] != val &#123;</span><br><span class="line">            <span class="comment">// 当遇到不等于 val 的元素时，将其移动到有效位置</span></span><br><span class="line">            nums[i] = nums[j]</span><br><span class="line">            i++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="977-有序数组的平方"><a href="#977-有序数组的平方" class="headerlink" title="977. 有序数组的平方"></a>977. 有序数组的平方</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sortedSquares</span><span class="params">(nums []<span class="type">int</span>)</span></span> []<span class="type">int</span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(nums)</span><br><span class="line">    result := <span class="built_in">make</span>([]<span class="type">int</span>, n)</span><br><span class="line">    left, right := <span class="number">0</span>, n<span class="number">-1</span></span><br><span class="line">    index := n - <span class="number">1</span> <span class="comment">// 从后往前填充</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> left &lt;= right &#123;</span><br><span class="line">        leftSquare := nums[left] * nums[left]</span><br><span class="line">        rightSquare := nums[right] * nums[right]</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 比较左右平方，较大者存入结果数组末尾</span></span><br><span class="line">        <span class="keyword">if</span> leftSquare &gt; rightSquare &#123;</span><br><span class="line">            result[index] = leftSquare</span><br><span class="line">            left++</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            result[index] = rightSquare</span><br><span class="line">            right--</span><br><span class="line">        &#125;</span><br><span class="line">        index--</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> 数组 </tag>
            
            <tag> 算法 </tag>
            
            <tag> 代码随想录算法训练营 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Android Studio JNI 开发详细教程</title>
      <link href="/2025/03/29/Android-Studio-JNI%E5%BC%80%E5%8F%91%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/"/>
      <url>/2025/03/29/Android-Studio-JNI%E5%BC%80%E5%8F%91%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1. 环境准备"></a>1. 环境准备</h2><p>安装 NDK 和 CMake</p><ul><li>打开 Android Studio → Tools → SDK Manager → SDK Tools</li><li>勾选 NDK (Native Development Kit) 和 CMake</li><li>点击 Apply 安装</li></ul><p><img src="https://pic1.imgdb.cn/item/67e804f50ba3d5a1d7e68485.png" alt="image-20250325095619376"></p><h2 id="2-创建新项目"><a href="#2-创建新项目" class="headerlink" title="2. 创建新项目"></a>2. 创建新项目</h2><p>新建项目</p><ul><li>选择”Empty Activity”模板</li><li>确保语言选择 Java（或 Kotlin，本例使用 Java）</li></ul><p><img src="https://pic1.imgdb.cn/item/67e804f40ba3d5a1d7e68483.png" alt="image-20250325095856866"></p><p><img src="https://pic1.imgdb.cn/item/67e804f40ba3d5a1d7e68482.png" alt="image-20250325100038611"></p><h2 id="3-配置-NDK-路径"><a href="#3-配置-NDK-路径" class="headerlink" title="3. 配置 NDK 路径"></a>3. 配置 NDK 路径</h2><p>在<code>local.properties</code>中添加：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ndk.dir</span>=<span class="string">/path/to/ndk  # 通常自动配置，无需手动修改</span></span><br></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/67e804f40ba3d5a1d7e68481.png" alt="image-20250325100531006"></p><h2 id="4-创建-Java-Native-接口"><a href="#4-创建-Java-Native-接口" class="headerlink" title="4. 创建 Java Native 接口"></a>4. 创建 Java Native 接口</h2><p>创建 Java 类</p><p><code>app/src/main/java/com/example/myjnidemo/NativeLib.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myjnidemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NativeLib</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;native-lib&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> String <span class="title function_">getNativeString</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">native</span> <span class="type">int</span> <span class="title function_">addNumbers</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-生成-C-C-头文件"><a href="#5-生成-C-C-头文件" class="headerlink" title="5. 生成 C&#x2F;C++头文件"></a>5. 生成 C&#x2F;C++头文件</h2><p>定位到 Java 目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> app/src/main/java</span><br></pre></td></tr></table></figure><p>生成头文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac -h ../cpp com/example/myjnidemo/NativeLib.java</span><br></pre></td></tr></table></figure><p>命令说明：</p><ul><li>编译<code>NativeLib.java</code>生成<code>.class</code>文件（存放于<code>app/src/main/java/com/example/myjnidemo/</code>）</li><li>生成 JNI 头文件<code>com_example_myjnidemo_NativeLib.h</code>（存放于<code>app/src/main/cpp/</code>）</li></ul><h2 id="6-编写-C-实现"><a href="#6-编写-C-实现" class="headerlink" title="6. 编写 C++实现"></a>6. 编写 C++实现</h2><p>在<code>app/src/main/cpp/native-lib.cpp</code>中：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;jni.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span>           <span class="comment">// 明确包含，为后续扩展做准备</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;com_example_myjnidemo_NativeLib.h&quot;</span>  <span class="comment">// 关键头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用头文件中的声明，避免签名错误</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function">JNIEXPORT jstring JNICALL</span></span><br><span class="line"><span class="function"><span class="title">Java_com_example_myjnidemo_NativeLib_getNativeString</span><span class="params">(JNIEnv* env, jobject)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 虽然当前未使用 std::string，但包含&lt;string&gt;可为后续优化留余地</span></span><br><span class="line">    std::string message = <span class="string">&quot;Hello from C++!&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> env-&gt;<span class="built_in">NewStringUTF</span>(message.<span class="built_in">c_str</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> <span class="function">JNIEXPORT jint JNICALL</span></span><br><span class="line"><span class="function"><span class="title">Java_com_example_myjnidemo_NativeLib_addNumbers</span><span class="params">(JNIEnv*, jobject, jint a, jint b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;  <span class="comment">// 基础类型操作无需字符串支持</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-配置-CMake"><a href="#7-配置-CMake" class="headerlink" title="7. 配置 CMake"></a>7. 配置 CMake</h2><p>创建&#x2F;修改<code>app/CMakeLists.txt</code>：</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.10</span>.<span class="number">2</span>)</span><br><span class="line"><span class="keyword">project</span>(<span class="string">&quot;native-lib&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">add_library</span>(native-lib SHARED src/main/cpp/native-lib.cpp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">find_library</span>(log-lib log)</span><br><span class="line"></span><br><span class="line"><span class="keyword">target_link_libraries</span>(native-lib <span class="variable">$&#123;log-lib&#125;</span>)</span><br></pre></td></tr></table></figure><h2 id="8-配置-Gradle"><a href="#8-配置-Gradle" class="headerlink" title="8. 配置 Gradle"></a>8. 配置 Gradle</h2><p>在<code>app/build.gradle</code>的 android 块内添加：</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        externalNativeBuild &#123;</span><br><span class="line">            cmake &#123;</span><br><span class="line">                cppFlags <span class="string">&quot;&quot;</span></span><br><span class="line">                abiFilters <span class="string">&quot;armeabi-v7a&quot;</span>, <span class="string">&quot;arm64-v8a&quot;</span>, <span class="string">&quot;x86&quot;</span>, <span class="string">&quot;x86_64&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    externalNativeBuild &#123;</span><br><span class="line">        cmake &#123;</span><br><span class="line">            path <span class="string">&quot;CMakeLists.txt&quot;</span></span><br><span class="line">            version <span class="string">&quot;3.10.2&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-使用-Native-方法"><a href="#9-使用-Native-方法" class="headerlink" title="9. 使用 Native 方法"></a>9. 使用 Native 方法</h2><p>在<code>MainActivity</code>中：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="type">NativeLib</span> <span class="variable">nativeLib</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NativeLib</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> nativeLib.getNativeString();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> nativeLib.addNumbers(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">TextView</span> <span class="variable">tv</span> <span class="operator">=</span> findViewById(R.id.sample_text);</span><br><span class="line">        tv.setText(text + <span class="string">&quot;\n5 + 3 = &quot;</span> + sum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-修改页面布局"><a href="#10-修改页面布局" class="headerlink" title="10. 修改页面布局"></a>10. 修改页面布局</h2><p>文件位置<code>app/src/main/res/layout/activity_main.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 用于显示 JNI 调用结果的 TextView --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">&quot;@+id/sample_text&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textSize</span>=<span class="string">&quot;24sp&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:textColor</span>=<span class="string">&quot;@android:color/black&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:text</span>=<span class="string">&quot;Hello from JNI!&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure><p>最终效果示意图</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------------+</span><br><span class="line">|         Hello from C++!     |</span><br><span class="line">|         5 + 3 = 8           |</span><br><span class="line">+-----------------------------+</span><br></pre></td></tr></table></figure><h2 id="11-构建运行"><a href="#11-构建运行" class="headerlink" title="11. 构建运行"></a>11. 构建运行</h2><ol><li>点击 Build → Make Project</li><li>运行到设备&#x2F;模拟器</li></ol><h2 id="12-完整的-JNI-项目文件树"><a href="#12-完整的-JNI-项目文件树" class="headerlink" title="12. 完整的 JNI 项目文件树"></a>12. 完整的 JNI 项目文件树</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MyJniDemo/                  <span class="comment"># 项目根目录</span></span><br><span class="line">├── gradle/                 <span class="comment"># Gradle 包装器</span></span><br><span class="line">├── app/                    <span class="comment"># 主模块</span></span><br><span class="line">│   ├── libs/               <span class="comment"># 第三方库（本项目未使用）</span></span><br><span class="line">│   ├── src/</span><br><span class="line">│   │   └── main/</span><br><span class="line">│   │       ├── java/</span><br><span class="line">│   │       │   └── com/</span><br><span class="line">│   │       │       └── example/</span><br><span class="line">│   │       │           └── myjnidemo/</span><br><span class="line">│   │       │               ├── MainActivity.java     <span class="comment"># 主 Activity</span></span><br><span class="line">│   │       │               └── NativeLib.java        <span class="comment"># JNI 接口类</span></span><br><span class="line">│   │       ├── cpp/</span><br><span class="line">│   │       │   ├── native-lib.cpp                    <span class="comment"># C++实现</span></span><br><span class="line">│   │       │   └── com_example_myjnidemo_NativeLib.h <span class="comment"># 生成的头文件</span></span><br><span class="line">│   │       ├── res/                                  <span class="comment"># 资源文件</span></span><br><span class="line">│   │       │   ├── layout/</span><br><span class="line">│   │       │   │   └── activity_main.xml            <span class="comment"># 布局文件</span></span><br><span class="line">│   │       │   └── values/</span><br><span class="line">│   │       │       └── strings.xml                   <span class="comment"># 字符串资源</span></span><br><span class="line">│   │       └── AndroidManifest.xml                   <span class="comment"># 清单文件</span></span><br><span class="line">│   ├── CMakeLists.txt                                <span class="comment"># CMake 配置文件</span></span><br><span class="line">│   └── build.gradle                                  <span class="comment"># 模块级 Gradle 配置</span></span><br><span class="line">├── gradle/                                           <span class="comment"># Gradle 相关文件</span></span><br><span class="line">├── settings.gradle                                   <span class="comment"># 项目级设置</span></span><br><span class="line">└── local.properties                                  <span class="comment"># NDK/SDK 路径配置</span></span><br></pre></td></tr></table></figure><p>构建后生成的。so 文件位置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">app/</span><br><span class="line">└── build/</span><br><span class="line">    └── intermediates/</span><br><span class="line">        └── cmake/</span><br><span class="line">            └── debug/</span><br><span class="line">                └── obj/</span><br><span class="line">                    ├── arm64-v8a/</span><br><span class="line">                    │   └── libnative-lib.so</span><br><span class="line">                    ├── armeabi-v7a/</span><br><span class="line">                    │   └── libnative-lib.so</span><br><span class="line">                    └── x86_64/</span><br><span class="line">                        └── libnative-lib.so</span><br></pre></td></tr></table></figure><p><img src="https://pic1.imgdb.cn/item/67e804f50ba3d5a1d7e68484.png" alt="image-20250325150834365"></p><p><img src="https://pic1.imgdb.cn/item/67e804f40ba3d5a1d7e68480.png" alt="image-20250325151048399"></p>]]></content>
      
      
      <categories>
          
          <category> 安卓逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JNI </tag>
            
            <tag> 安卓开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在 Smali 代码中插入 Log</title>
      <link href="/2025/03/23/%E5%9C%A8Smali%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%8F%92%E5%85%A5Log/"/>
      <url>/2025/03/23/%E5%9C%A8Smali%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%8F%92%E5%85%A5Log/</url>
      
        <content type="html"><![CDATA[<h2 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1. 准备工作"></a>1. 准备工作</h2><p>工具准备：</p><ul><li>Apktool：用于反编译和重新打包 APK</li><li>签名工具：jarsigner（JDK 自带）或 apksigner（Android SDK 提供）</li><li>调试工具：adb logcat 查看日志</li></ul><p>操作流程：<br>反编译 APK -&gt; 修改 Smali 代码 -&gt; 重新打包 -&gt; 签名 -&gt; 安装测试</p><h2 id="2-反编译-APK"><a href="#2-反编译-APK" class="headerlink" title="2. 反编译 APK"></a>2. 反编译 APK</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool d target.apk -o output_dir</span><br></pre></td></tr></table></figure><p>反编译后，Smali 代码位于 output_dir&#x2F;smali 目录中</p><h2 id="3-在-Smali-代码中插入日志"><a href="#3-在-Smali-代码中插入日志" class="headerlink" title="3. 在 Smali 代码中插入日志"></a>3. 在 Smali 代码中插入日志</h2><h3 id="3-1-定位目标代码"><a href="#3-1-定位目标代码" class="headerlink" title="3.1. 定位目标代码"></a>3.1. 定位目标代码</h3><ul><li>通过逆向工具（如 Jadx）分析目标代码的大致位置，找到对应的 Smali 文件</li><li>例如：目标代码在 com.example.MainActivity，则 Smali 文件为：</li><li><code>smali/com/example/MainActivity.smali</code></li></ul><h3 id="3-2-插入日志的-Smali-指令"><a href="#3-2-插入日志的-Smali-指令" class="headerlink" title="3.2. 插入日志的 Smali 指令"></a>3.2. 插入日志的 Smali 指令</h3><p>在 Smali 中调用<code>Log.d()</code>需要以下步骤：</p><ol><li>定义 TAG（可选）：在类中定义一个静态字符串作为 TAG</li><li>加载参数：将 TAG 和日志内容加载到寄存器</li><li>调用静态方法：执行<code>Log.d(TAG, message)</code></li></ol><p>示例：在方法中插入日志代码</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原始代码（假设在方法 .method public onCreate()V 内）</span></span><br><span class="line"><span class="keyword">.line</span> 10<span class="built_in"></span></span><br><span class="line"><span class="built_in">const/4 </span>v0, 0x1<span class="built_in"></span></span><br><span class="line"><span class="built_in">iput-boolean </span>v0, p0, <span class="class">Lcom/example/MainActivity;</span>-&gt;isReady:Z</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入日志代码（添加如下指令）</span><span class="built_in"></span></span><br><span class="line"><span class="built_in">const-string </span>v1, <span class="string">&quot;MyTag&quot;</span>           <span class="comment"># 定义 TAG</span><span class="built_in"></span></span><br><span class="line"><span class="built_in">const-string </span>v2, <span class="string">&quot;Debug message&quot;</span>   <span class="comment"># 日志内容</span><span class="built_in"></span></span><br><span class="line"><span class="built_in">invoke-static </span>&#123;v1, v2&#125;, <span class="class">Landroid/util/Log;</span>-&gt;d(<span class="class">Ljava/lang/String;</span><span class="class">Ljava/lang/String;</span>)I</span><br></pre></td></tr></table></figure><h3 id="3-3-注意事项"><a href="#3-3-注意事项" class="headerlink" title="3.3. 注意事项"></a>3.3. 注意事项</h3><ul><li>寄存器冲突：确保<code>v1</code>、<code>v2</code>等寄存器未被占用（根据上下文调整寄存器编号）</li><li>参数顺序：<code>Log.d()</code>的第一个参数是<code>TAG</code> (String)，第二个参数是<code>message</code> (String)</li></ul><h2 id="4-重新打包-APK"><a href="#4-重新打包-APK" class="headerlink" title="4. 重新打包 APK"></a>4. 重新打包 APK</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apktool b output_dir -o unsigned.apk</span><br></pre></td></tr></table></figure><p>生成的<code>unsigned.apk</code>是未签名的 APK</p><h2 id="5-签名-APK"><a href="#5-签名-APK" class="headerlink" title="5. 签名 APK"></a>5. 签名 APK</h2><h3 id="5-1-生成签名密钥（若无可跳过，使用已有密钥）"><a href="#5-1-生成签名密钥（若无可跳过，使用已有密钥）" class="headerlink" title="5.1. 生成签名密钥（若无可跳过，使用已有密钥）"></a>5.1. 生成签名密钥（若无可跳过，使用已有密钥）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -genkey -v -keystore mykey.keystore -<span class="built_in">alias</span> myalias -keyalg RSA -keysize 2048 -validity 10000</span><br></pre></td></tr></table></figure><h3 id="5-2-使用-jarsigner-签名"><a href="#5-2-使用-jarsigner-签名" class="headerlink" title="5.2. 使用 jarsigner 签名"></a>5.2. 使用 jarsigner 签名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore mykey.keystore unsigned.apk myalias</span><br></pre></td></tr></table></figure><p>输出文件为<code>signed.apk</code></p><h3 id="5-3-使用-apksigner-签名（推荐）"><a href="#5-3-使用-apksigner-签名（推荐）" class="headerlink" title="5.3. 使用 apksigner 签名（推荐）"></a>5.3. 使用 apksigner 签名（推荐）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apksigner sign --ks mykey.keystore --ks-key-alias myalias signed.apk unsigned.apk</span><br></pre></td></tr></table></figure><h2 id="6-安装并测试"><a href="#6-安装并测试" class="headerlink" title="6. 安装并测试"></a>6. 安装并测试</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb install signed.apk</span><br><span class="line">adb logcat -s <span class="string">&quot;MyTag&quot;</span>   <span class="comment"># 过滤日志</span></span><br></pre></td></tr></table></figure><h2 id="7-常见问题与解决"><a href="#7-常见问题与解决" class="headerlink" title="7. 常见问题与解决"></a>7. 常见问题与解决</h2><h3 id="7-1-应用崩溃或无法启动"><a href="#7-1-应用崩溃或无法启动" class="headerlink" title="7.1. 应用崩溃或无法启动"></a>7.1. 应用崩溃或无法启动</h3><ul><li>原因：Smali 代码修改错误（如寄存器冲突、指令格式错误）</li><li>解决：<ol><li>检查插入的 Smali 指令语法</li><li>使用<code>adb logcat</code>查看崩溃日志（过滤 AndroidRuntime）</li></ol></li></ul><h3 id="7-2-日志未输出"><a href="#7-2-日志未输出" class="headerlink" title="7.2. 日志未输出"></a>7.2. 日志未输出</h3><ul><li>原因：<ul><li>代码未被执行（断点位置错误）</li><li>日志 TAG 过滤错误</li></ul></li><li>解决：<ol><li>检查插入日志的代码路径是否触发</li><li>使用<code>adb logcat -s MyTag:*</code>确保过滤正确</li></ol></li></ul><h3 id="7-3-签名后安装失败"><a href="#7-3-签名后安装失败" class="headerlink" title="7.3. 签名后安装失败"></a>7.3. 签名后安装失败</h3><ul><li>原因：签名不兼容或 APK 未对齐</li><li>解决：<ol><li>使用<code>zipalign</code>对齐 APK：<code>zipalign -v 4 unsigned.apk aligned.apk</code></li><li>确保使用<code>apksigner</code>而非旧版<code>jarsigner</code>，<code>jarsigner</code>仅支持 V1 签名，需改用<code>apksigner</code>生成 V2&#x2F;V3 签名</li></ol></li></ul><h2 id="8-完整操作流程示例"><a href="#8-完整操作流程示例" class="headerlink" title="8. 完整操作流程示例"></a>8. 完整操作流程示例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 反编译 APK（使用 Apktool）</span></span><br><span class="line">apktool d original.apk -o decoded</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 修改 Smali 代码后重新打包</span></span><br><span class="line">apktool b decoded -o unsigned.apk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 对齐 APK</span></span><br><span class="line">zipalign -v 4 unsigned.apk aligned.apk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 删除旧签名信息（避免冲突）</span></span><br><span class="line">zip -d aligned.apk <span class="string">&#x27;META-INF/*&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 使用 apksigner 签名</span></span><br><span class="line">apksigner sign \</span><br><span class="line">  --ks mykey.keystore \</span><br><span class="line">  --ks-key-alias myalias \</span><br><span class="line">  --out signed.apk \</span><br><span class="line">  aligned.apk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 验证签名</span></span><br><span class="line">apksigner verify -v signed.apk</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 安装测试</span></span><br><span class="line">adb install signed.apk</span><br></pre></td></tr></table></figure><p>如果无法安装 zip，可以通过以下方式手动删除 META-INF 文件夹：</p><ol><li>使用解压工具（如 7-Zip、WinRAR）打开 aligned.apk</li><li>删除 META-INF 文件夹</li><li>保存并关闭</li></ol>]]></content>
      
      
      <categories>
          
          <category> 安卓逆向 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Smali </tag>
            
            <tag> 安卓逆向 </tag>
            
            <tag> APK 打包签名 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/03/20/hello-world/"/>
      <url>/2025/03/20/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
